#|------------------------------------------- GAME OUTPUT -------------------------------------------|#

(defun PrintResult(Players Points Looser)
   (format t "~%~a~%" "-------------------------------------------------------------------------")
   (format t "~a~%" "Spele ir beigusies. Speletajiem tika pieskaitits sekojoss soda punktu      ")
   (format t "~a~%" "skaits:")

   ;; (format t " ~{~A~#[~:;~% ~]~}" Players)
   (DisplayList 1 Players Points)
   
   (cond ((equal (length Looser) 1)
          (format t "~%~%~a~%" "=========================================================================")     
          (format t "                        Speli ir zaudejis ~@(~a.~)~%" (car Looser)                   ) 
          (format t "~a~%" "========================================================================="))
         (t(equal (length Looser) 2) 
            (format t "~%~%~a~%" "=========================================================================")     
            (format t "                    Speli ir zaudejis ~@(~a~) ~(~a.~)~%" (car Looser) (cadr Looser)  ) 
            (format t "~a~%" "========================================================================="))
))

(defun DisplayList(i lst l)
    (cond ((null lst) nil)
          (T (cond((equal (length (car lst)) 1)
                   (format t "~& ~{~2d) ~@(~2@a:~) ~(~1@a~)~}" (list i (caar lst) (caar l)))
                   (DisplayList (+ i 1) (cdr lst) (cdr l)))
                  ((equal (length (car lst)) 2)
                   (format t "~& ~{~2d) ~@(~2@a~) ~(~1@a:~) ~(~1@a~)~}" (list i (caar lst) (cadar lst) (caar l)))
                   (DisplayList (+ i 1) (cdr lst) (cdr l)))))
))

#|--------------------------------------------------------------------------------------------------|#

(defun PrintCards(Player Cards)
    (format t "~%~@(~a~):~%" Player)
    (DisplayCard (Redraw Cards) 1)
    (format t "~%")
)

(defun Redraw(lst)
   (cond ((null lst) nil)
         (t(apend(GetNominal (caar lst)) (Redraw (cdr lst))))
))

(defun GetNominal(nm)
    (cond 
         ((equal nm 7) 'septinieks)
         ((equal nm 8) 'astotnieks)
         ((equal nm 9) 'devitnieks)
         ((equal nm 10) 'desmitnieks)
         ((equal nm 11) 'kalps)
         ((equal nm 12) 'damma)
         ((equal nm 13) 'kungs)
         ((equal nm 14) 'duzis)
))

(defun GetMast(mst)
    (cond 
         ((equal mst 1) 'sirds)
         ((equal mst 2) 'bubi)
         ((equal mst 3) 'kristi)
         ((equal mst 4) 'piki)
))

(defun DisplayCard(lst i)
    (cond ((null lst) nil)
           (t(format t "~& ~{~2d) ~(~2@a~) ~(~1@a~)~}" (list i (caar lst) (cadar lst)))
           (DisplayCard (cdr lst) (+ i 1)))
))

#|--------------------------------------------------------------------------------------------------|#

(defun PrintRules(num)
    (cond ((equal num 0)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                           Speles noteikumi:                             ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "   Spele \"King\". Speletaju kartiba cilveks - dators - cilveks - dators.")
           (format t "~a~%" "Spele tiek izmantotas 32 kartis (karsu komplekta neietilpst sesinieki).  ")
           (format t "~a~%" "Spele sastav no 6 apaksspelem, kas sakas, kad kartis tiek izdalitas un   ") 
           (format t "~a~%" "beidzas, kad visas tiek izmestas ara.")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "   Pirmais, kas sak apaksspeli izmet ara vienu karts, parejiem ir jaizmet")
           (format t "~a~%" "ara tada pasa masts karts, ja tada masts nav, ir jaizmet ara jebkura cita")
           (format t "~a~%" "masts karts. Speletajs, kurs izmeta ara vajadzigas masts karti ar")
           (format t "~a~%" "vislielako nominalu, nem ta saucamo stiki. Tam, kurs panema stiki, tiek")
           (format t "~a~%~%" "pieskaititi soda punkti atkariba no apaksspeles noteikumiem."))
          ((equal num 1)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                           Pirma apaksspele:                             ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "  Nedrikst nemt nevienu no stikiem. Par katru panemto stiki 2 soda punkti")
           (format t "~a~%~%" "(-2). Maksimalais soda punktu skaits: -16."))
          ((equal num 2)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                           Otra apaksspele:                              ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "  Nedrikst nemt nevienu sirds karti. Par katru panemto sirds karti 2 soda") 
           (format t "~a~%" "punkti (-2). Nedrikst sakt speli ar sirds kartim, ja rokas ir citas masts")
           (format t "~a~%~%" "kartis. Maksimalais soda punktu skaits: -16."))
          ((equal num 3)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                            Tresa apaksspele:                            ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "  Nedrikst nemt nevienu kalpu. Par katru panemto kalpu 4 soda punkti(-4).") 
           (format t "~a~%~%" "Maksimalais soda punktu skaits: -16."))
          ((equal num 4)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                           Ceturta appakspele:                           ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "   Nedrikst nemt nevienu damu. Par katru panemto damu 4 soda punkti (-4).") 
           (format t "~a~%~%" "Maksimalais soda punktu skaits: -16."))
          ((equal NUM 5)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                           Piekta appakspele:                            ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "   Nedrikst nemt 2 pedejus stikus. Par katru panemto stiki 8 soda punkti ") 
           (format t "~a~%~%" "(-8). Maksimalais soda punktu skaits: -16."))
          ((equal NUM 6)
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "                            Sesta appakspele:                            ")
           (format t "~a~%" "-------------------------------------------------------------------------")
           (format t "~a~%" "  Nedrikst nemt sirds karali. Ja uz rokam nav vajadzigas masts karts un  ")
           (format t "~a~%" "ir sirds karalis, tad obligati ir jaiet ar to. Par sirds karali 16 soda  ")
           (format t "~a~%" "punkti (-16). Nedrikst sakt speli ar sirds kartim, ja uz rokam ir citu   ")
           (format t "~a~%~%" "mastu kartis."))
))

#|--------------------------------------------------------------------------------------------------|#

(defun PrintError(num)
  (cond ((= num 0)
         (format nil "~a" "Spele var spelet tikai 4 speletaji!"))
        ((= num 1)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jums nav pieejama tada karts. Ievadiet karts numuru, ar kuru Jus"    ) 
         (format t "~a~%" "gribat izdarit gajienu."                                                    )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 2)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jus nevarat izmest so karti, Jums uz rokam ir bubi. Ievadiet karts"  ) 
         (format t "~a~%" "numuru, ar kuru Jus gribat izdarit gajienu."                                )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 3)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jus nevarat izmest so karti, Jums uz rokam ir krusti. Ievadiet      ") 
         (format t "~a~%" "karts numuru, ar kuru Jus gribat izdarit gajienu."                          )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 4)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jus nevarat izmest so karti, Jums uz rokam ir piki. Ievadiet karts"  ) 
         (format t "~a~%" "numuru, ar kuru Jus gribat izdarit gajienu."                                )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 5)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jus nevarat izmest so karti, Jums uz rokam ir sirdis. Ievadiet      ") 
         (format t "~a~%" "karts numuru, ar kuru Jus gribat izdarit gajienu."                          )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 6)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Kluda! Jus nedrikstat sakt speli ar sirds masts karti, jo Jums uz rokam    ") 
         (format t "~a~%" "ir citu masts kartis. Ievadiet karts numuru, ar kuru Jus saksiet speli."    )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
        ((= num 7)
         (format t "~%~a~%" "-------------------------------------------------------------------------")
         (format t "~a~%" "Jus nedriksat izdarit sadu gajienu! Jums uz rokam ir sirds karalis, ar     ") 
         (format t "~a~%" "kuru Jums obligati ir jastaiga."                                            )
         (format t "~a~%" "-------------------------------------------------------------------------" ))
))


#|--------------------------------------------------------------------------------------------------|#

;(defun PrintMessage(Player Points)
;)

;; PrintCards 'Anna '((7 4) (8 4) (9 4) (10 4) (11 4) (12 4) (13 4) (14 4) (7 2) (8 2) (9 2) (10 2) (11 2) (12 2) (13 2) (14 2))

;; PrintResult '((Anna) (Pirmais dators) (Vasilijs) (Otrais dators)) '((-16) (-16) (-12) (-20)) '(Otrais dators)
